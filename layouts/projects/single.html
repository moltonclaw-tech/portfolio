{{ define "main" }}
<article class="project-detail">
    <div class="project-content">

        {{/* Image Gallery */}}
        <div class="project-gallery">
            {{ range .Params.images }}
            <figure class="project-image">
                <img src="{{ . }}" alt="{{ $.Title }}">
            </figure>
            {{ end }}
        </div>

        {{/* Project Info Sidebar */}}
        <aside class="project-info">
            <h1 class="project-title">{{ .Title }}</h1>

            {{ with .Description }}
            <p class="project-description">{{ . | markdownify }}</p>
            {{ end }}

            <div class="project-meta">
                {{ with .Params.year }}
                <div class="meta-item">
                    <span class="meta-label">Year</span>
                    <span class="meta-value">{{ . }}</span>
                </div>
                {{ end }}
            </div>

            {{ with .Params.tools }}
            <div class="project-tools">
                <h3>Tools Used</h3>
                <ul class="tools-list">
                    {{ range . }}
                    <li>{{ . }}</li>
                    {{ end }}
                </ul>
            </div>
            {{ end }}
        </aside>

        {{/* Project Content */}}
        <div class="project-text">
            {{ .Content }}
        </div>

        {{/* Videos */}}
        {{ range .Params.videos }}
        <div class="project-video">
            {{ if hasPrefix . "http" }}
                {{ if in . "youtube.com" }}
                {{ $parts := split . "/" }}
                {{ $videoId := index $parts (sub (len $parts) 1) }}
                <iframe src="https://www.youtube.com/embed/{{ $videoId }}" frameborder="0" allowfullscreen></iframe>
                {{ else if in . "youtu.be" }}
                {{ $videoId := replace . "https://youtu.be/" "" }}
                <iframe src="https://www.youtube.com/embed/{{ $videoId }}" frameborder="0" allowfullscreen></iframe>
                {{ else if in . "vimeo.com" }}
                {{ $parts := split . "/" }}
                {{ $videoId := index $parts (sub (len $parts) 1) }}
                <iframe src="https://player.vimeo.com/video/{{ $videoId }}" frameborder="0" allowfullscreen></iframe>
                {{ else }}
                <video controls>
                    <source src="{{ . }}" type="video/mp4">
                </video>
                {{ end }}
            {{ else }}
            <video controls>
                <source src="{{ . | relURL }}" type="video/mp4">
            </video>
            {{ end }}
        </div>
        {{ end }}

    </div>

    <nav class="project-nav">
        {{ with .PrevInSection }}
        <a href="{{ .Permalink }}" class="nav-prev">&larr; {{ .Title }}</a>
        {{ end }}
        {{ with .NextInSection }}
        <a href="{{ .Permalink }}" class="nav-next">{{ .Title }} &rarr;</a>
        {{ end }}
    </nav>
</article>
{{ end }}
