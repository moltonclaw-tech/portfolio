{{ define "main" }}
{{ $allProjects := where site.Pages "Section" "projects" }}
{{ $actualProjects := where $allProjects "Title" "!=" "Projects" }}
{{ $sortedProjects := sort $actualProjects "Params.importance" "desc" }}

<section class="projects-grid">
    {{ range $sortedProjects }}
    {{ $importance := .Params.importance | default 1 }}
    {{ $class := cond (eq $importance 1) "importance-1" (cond (eq $importance 2) "importance-2" (cond (eq $importance 3) "importance-3" (cond (ge $importance 4) "importance-4" "importance-1"))) }}
    <a href="{{ .RelPermalink }}" class="project-card {{ $class }}">
        <div class="project-thumb">
            <img src="/thumbs/{{ .Params.thumbnail }}" alt="{{ .Title }}">
            <div class="project-overlay">
                <h3 class="project-title">{{ .Title }}</h3>
            </div>
        </div>
    </a>
    {{ end }}
</section>
{{ end }}
